<?phpclass WC_Scalapay_Gateway{    protected $loader;    protected $plugin_name;    protected $version;    public function __construct()    {        if (defined('WC_SCALAPAY_VERSION')) {            $this->version = WC_SCALAPAY_VERSION;        } else {            $this->version = '1.1.40';        }        $this->plugin_name = 'wc-scalapay-gateway';        if (!defined('WC_SCALAPAY_PLUGIN_NAME')) {            define('WC_SCALAPAY_PLUGIN_NAME', $this->plugin_name);        }        $prefix = is_network_admin() ? 'network_admin_' : '';        add_filter("{$prefix}plugin_action_links_" . WC_SCALAPAY_GATEWAY_BASE_NAME, array($this, 'wc_scalapay_gateway_plugin_links'), 10, 4);        add_action('admin_init', array($this, 'wc_scalapay_plugin_redirect'));        $this->load_dependencies();        $this->set_locale();        $this->define_admin_hooks();    }    public function wc_scalapay_plugin_redirect() {        if (get_option('wc_scalapay_do_activation_redirect', false)) {            delete_option('wc_scalapay_do_activation_redirect');            if (!isset($_GET['activate-multi'])) {                wp_redirect("admin.php?page=wc-settings&tab=checkout&section=wc-scalapay-payin3&act=general-settings"); exit;            }        }    }    public function wc_scalapay_gateway_plugin_links($actions, $plugin_file, $plugin_data, $context) {        $custom_actions = array(            'configure' => sprintf('<a href="%s">%s</a>', admin_url('admin.php?page=wc-settings&tab=checkout&section=wc-scalapay-payin3'),                __('Settings', 'wc-scalapay-gateway')));        return array_merge($custom_actions, $actions);    }    private function define_admin_hooks() {        $plugin_admin = new WC_Scalapay_Gateway_Admin($this->get_plugin_name(), $this->get_version());        $this->loader->add_action('admin_enqueue_scripts', $plugin_admin, 'backend_enqueue_styles', 0);        $this->loader->add_action('admin_enqueue_scripts', $plugin_admin, 'backend_enqueue_scripts');        $this->loader->add_action('wp_enqueue_scripts', $plugin_admin, 'frontend_enqueue_scripts');        $this->loader->add_filter('script_loader_tag', $plugin_admin, 'add_type_attribute_scalapay' , 10, 3);        $this->loader->add_action('plugins_loaded', $plugin_admin, 'init_wc_scalapay_payment');        $this->loader->add_filter('woocommerce_payment_gateways', $plugin_admin, 'wc_scalapay_add_payment_method_class', 9999, 1);        //product page hooks        $payin3_settings = get_option('woocommerce_wc-scalapay-payin3_settings');        if (!empty($payin3_settings)) {            $product_hook    = $payin3_settings['product_hook'];            $cart_hook    = $payin3_settings['cart_hook'];            $this->loader->add_action($product_hook, $plugin_admin, 'display_scalapay_widget_product_payin3', 10);            $this->loader->add_action($cart_hook, $plugin_admin, 'display_scalapay_widget_cart_payin3', 10);        }        $payin4_settings = get_option('woocommerce_wc-scalapay-payin4_settings');        if (!empty($payin4_settings)) {            $product_hook = $payin4_settings['product_hook'];            $cart_hook    = $payin4_settings['cart_hook'];            $this->loader->add_action($product_hook, $plugin_admin, 'display_scalapay_widget_product_payin4', 10);            $this->loader->add_action($cart_hook, $plugin_admin, 'display_scalapay_widget_cart_payin4', 10);        }        $paylater_settings = get_option('woocommerce_wc-scalapay-paylater_settings');        if (!empty($paylater_settings)) {            $product_hook    = $paylater_settings['product_hook'];            $cart_hook    = $paylater_settings['cart_hook'];            $this->loader->add_action($product_hook, $plugin_admin, 'display_scalapay_widget_product_paylater', 10);            $this->loader->add_action($cart_hook, $plugin_admin, 'display_scalapay_widget_cart_paylater', 10);        }    }    private function load_dependencies() {        require_once WC_SCALAPAY_GATEWAY_DIR_PATH . 'classes/wc-scalapay-gateway-loader.php';        require_once WC_SCALAPAY_GATEWAY_DIR_PATH . 'classes/wc-scalapay-gateway-i18n.php';        require_once WC_SCALAPAY_GATEWAY_DIR_PATH . 'classes/admin/wc-scalapay-gateway-admin.php';        $this->loader = new WC_Scalapay_Gateway_Loader();    }    public function run() {        $this->loader->run();    }    public function get_plugin_name() {        return $this->plugin_name;    }    public function get_version() {        return $this->version;    }    public function set_locale() {        $plugin_i18n = new WC_Scalapay_Gateway_i18n();        $this->loader->add_action('plugins_loaded', $plugin_i18n, 'load_plugin_textdomain');    }}